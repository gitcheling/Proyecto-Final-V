
-- ##############################################################################################################
-- CREAR LAS TABLAS
-- ##############################################################################################################


-- #######################################################
-- # 1. TABLAS MAESTRAS BÁSICAS (CATÁLOGOS)
-- #######################################################

-- 1.1. BANCO
CREATE TABLE banco (
    "id_banco" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(100) NOT NULL,
	"codigo_nacional" VARCHAR(4) UNIQUE NOT NULL,
    "codigo_swift" VARCHAR(15) UNIQUE NOT NULL
);

-- 1.3. TIPO_IDENTIFICACION
CREATE TABLE tipo_identificacion (
    "id_tipo_identificacion" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
    "abreviatura" VARCHAR(10) UNIQUE
);

-- 1.4. TIPO_COMPROBANTE (Documento Legal/Fiscal)
CREATE TABLE tipo_comprobante (
    "id_comprobante" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
    "descripcion" VARCHAR(255) NOT NULL,

    --La columna es_legal es importante: si es TRUE, el documento tiene validez fiscal o contable externa; si es FALSE, es un 
    --documento de soporte operativo interno o contractual.
    "es_legal" BOOLEAN NOT NULL 
);


-- 1.6. DIVISA
CREATE TABLE divisa (
    "id_divisa" SERIAL PRIMARY KEY,
	"nombre" VARCHAR(50) NOT NULL,
	"codigo" VARCHAR(10) NOT NULL,
	"simbolo" VARCHAR(5) NOT NULL
);

-- 1.7. TIPO_PROVEEDOR
CREATE TABLE tipo_proveedor (
    "id_tipo_proveedor" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
    "descripcion" VARCHAR(255)
);

-- 1.8. TIPO_ENTIDAD
CREATE TABLE tipo_entidad (
    "id_tipo_entidad" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
	"descripcion" VARCHAR(100) NOT NULL
);

-- 1.9. PREFIJO_IDENTIFICACION
CREATE TABLE prefijo_identificacion (
    "id_prefijo" SERIAL PRIMARY KEY,
    "letra_prefijo" CHAR(1) NOT NULL,
	"descripcion" VARCHAR(50) NOT NULL
);

-- 1.10. ESTADO_ACADEMICO
CREATE TABLE estado_academico (
    "id_estado_academico" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(150) NOT NULL,
	"descripcion" VARCHAR(120) NOT NULL,
	"permite_inscripcion" BOOLEAN NOT NULL
);

-- 1.11. CATEGORIA_CURSO
CREATE TABLE categoria_curso (
    "id_categoria_curso" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
	"descripcion" VARCHAR(255) NOT NULL,
    "id_categoria_padre" INT, -- Clave foránea que apunta a esta misma tabla.

    FOREIGN KEY (id_categoria_padre) REFERENCES categoria_curso(id_categoria_curso)
);

-- 1.12. ESTADO_GRUPO
CREATE TABLE estado_grupo (
    "id_estado_grupo" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
	"descripcion" VARCHAR(150) NOT NULL,
    "permite_inscripcion" BOOLEAN NOT NULL
);

-- 1.13. ESTADO_INSCRIPCION
CREATE TABLE estado_inscripcion (
    "id_estado_inscripcion" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
    "descripcion" VARCHAR(255) NOT NULL,
    "puede_ver_clase" BOOLEAN NOT NULL,
	"ciclo_cerrado" BOOLEAN NOT NULL
);

-- 1.14. NATURALEZA
CREATE TABLE naturaleza (
    "id_naturaleza" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL
);

-- 1.15. CLASIFICACION
CREATE TABLE clasificacion (
    "id_clasificacion" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL
);


-- 1.17. ESTADO_DOCENTE
CREATE TABLE estado_docente (
    "id_estado_docente" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
	"descripcion" VARCHAR(100) NOT NULL,
	"permite_asignacion" BOOLEAN NOT NULL,
	"aplica_pago" BOOLEAN NOT NULL
);


-- 1.19. ESTADO_CUENTA_BANCARIA (Estado de la cuenta: Activa, Bloqueada, Cerrada)
CREATE TABLE estado_cuenta_bancaria (
    "id_estado_cuenta" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL UNIQUE,
    "descripcion" VARCHAR(255) NOT NULL,
    "permite_operacion" BOOLEAN NOT NULL
);


-- 1.20. TIPO_CUENTA_BANCARIA (Ahorro, Corriente, etc.)
CREATE TABLE tipo_cuenta_bancaria (
    "id_tipo_cuenta" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL UNIQUE,
    "descripcion" VARCHAR(255)
);

-- 1.21. TIPO_ROL_ASOCIADO (se usa para asociar una cuenta a un tipo de entidad, pero se necesita diferenciar si la cuenta es 
-- para pagarle a un docente o proveedor, o para recibir pagos de un estudiante
CREATE TABLE tipo_rol_asociado (
    "id_tipo_rol" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL UNIQUE,  -- Ej: 'docente', 'proveedor', 'estudiante'
    "descripcion" VARCHAR(255) NOT NULL
);


-- 1.22. ESTADO_PROVEEDOR 
CREATE TABLE estado_proveedor (
    "id_estado_proveedor" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL UNIQUE,
    "descripcion" VARCHAR(255),
    "permite_pago" BOOLEAN NOT NULL -- Indica si la relación con el proveedor permite pagos
);


-- 1.23. ESTADO_CURSO 
CREATE TABLE estado_curso (
    "id_estado_curso" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) NOT NULL,
    "descripcion" VARCHAR(255),
    "permite_nuevos_grupos" BOOLEAN NOT NULL, 
    
    UNIQUE (nombre)
); 


-- 1.24. MODALIDAD_CLASE
CREATE TABLE modalidad_clase (
    id_modalidad SERIAL PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL,
    descripcion VARCHAR(100) NOT NULL,
    UNIQUE (nombre)
);


-- 1.25. ESTADO_OBLIGACION (Nueva tabla maestra para Pago, Vencimiento, etc.)
CREATE TABLE estado_obligacion (
    id_estado_obligacion SERIAL PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL UNIQUE,
    descripcion VARCHAR(255) NOT NULL,
    es_finalizado BOOLEAN NOT NULL
);


-- 1.26. TIPO_MOVIMIENTO (Si es Ingreso o Egreso, para la tabla "registro_transaccion)
CREATE TABLE tipo_movimiento (
    id_tipo_movimiento SERIAL PRIMARY KEY,
    nombre VARCHAR(10) NOT NULL UNIQUE, -- 'INGRESO' o 'EGRESO'
    descripcion VARCHAR(255) NOT NULL
);



-- 1.27. METODO_PAGO (NUEVA MAESTRA: Efectivo, Transferencia, Tarjeta, etc.)
CREATE TABLE metodo_pago (
    id_metodo_pago SERIAL PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL UNIQUE, 
    descripcion VARCHAR(255) NOT NULL,
    requiere_referencia BOOLEAN NOT NULL -- Si necesita número de cheque/transferencia
);


-- 1.28. CONCEPTO_FINANCIERO
--La Causa del Ingreso/Gasto: Permite saber si una obligación es por "Pago de Matrícula", "Sueldo de Docente", "Compra de Equipos", etc.
CREATE TABLE concepto_financiero (
    id_concepto SERIAL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    descripcion VARCHAR(255) NOT NULL,
	id_concepto_padre INT REFERENCES concepto_financiero(id_concepto),

    -- Determina si es una obligación de un cliente (TRUE) o un gasto/nómina de la academia (FALSE)
    es_por_cobrar BOOLEAN,

    -- Determina si es una cuenta que invierte el flujo de cobro (e.g., "Reembolso" hace que la cuenta "cuentas por cobrar" se le
    --asigne dinero por el lado contrario)
    es_obligacion_negativa BOOLEAN NOT NULL 
);



-- #######################################################
-- # 2. TABLAS MAESTRAS DE ENTIDADES
-- #######################################################

-- 2.1. ENTIDAD (Superclase para Personas/Empresas)
CREATE TABLE entidad (
    "id_entidad" SERIAL PRIMARY KEY,
	"id_tipo_entidad" INT REFERENCES tipo_entidad(id_tipo_entidad) NOT NULL,
	"id_tipo_identificacion" INT REFERENCES tipo_identificacion(id_tipo_identificacion) NOT NULL,
    "id_prefijo" INT REFERENCES prefijo_identificacion(id_prefijo) NOT NULL,
	"numero_identificacion" VARCHAR(20) NOT NULL,
	"nombre" VARCHAR(100) NOT NULL,
    "apellido" VARCHAR(100),
	"email" VARCHAR(100) UNIQUE NOT NULL,
    "telefono" VARCHAR(20) NOT NULL,
	"direccion" VARCHAR(255) NOT NULL,
    "estado" BOOLEAN DEFAULT TRUE,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,

    CONSTRAINT entidad_unica UNIQUE (id_prefijo , id_tipo_identificacion, numero_identificacion) -- Esto garantiza que una persona no pueda tener dos Cédulas, dos RIF, o dos Pasaportes. Sin embargo, sí puede tener un Pasaporte, una Cédula y un RIF, aunque los números sean iguales (como es común con los RIF de personas naturales).
);



-- 2.2. ESTUDIANTE (Rol)
CREATE TABLE estudiante (
    "id_estudiante" INT PRIMARY KEY REFERENCES entidad(id_entidad),
	"codigo_estudiantil" VARCHAR(8) UNIQUE NOT NULL,
    "id_estado_academico" INT REFERENCES estado_academico(id_estado_academico) NOT NULL,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL
);


-- 2.3. DOCENTE (Rol)
CREATE TABLE docente (
    "id_docente" INT PRIMARY KEY REFERENCES entidad(id_entidad),
	"id_estado_docente" INT REFERENCES estado_docente(id_estado_docente) NOT NULL,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL
);



-- 2.4. PROVEEDOR (Rol)
CREATE TABLE proveedor (
    "id_proveedor" INT PRIMARY KEY REFERENCES entidad(id_entidad),
    "id_tipo_proveedor" INT REFERENCES tipo_proveedor(id_tipo_proveedor),
    "id_estado_proveedor" INT REFERENCES estado_proveedor(id_estado_proveedor),
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL
);



-- #######################################################
-- # 3. MÓDULO ACADÉMICO/SERVICIOS
-- #######################################################

-- 3.1. CURSO
CREATE TABLE curso (
    "id_curso" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(50) UNIQUE NOT NULL,
    "descripcion" VARCHAR(255) NOT NULL,
	"id_categoria" INT REFERENCES categoria_curso(id_categoria_curso) NOT NULL,
    "total_clases" INT NOT NULL,
    "id_estado" INT REFERENCES estado_curso(id_estado_curso) NOT NULL,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL
);




-- Tabla: PERIODO
-- Define los ciclos académicos (Ej. '2025-I', 'Verano 2026').
CREATE TABLE periodo (
    "id_periodo" SERIAL PRIMARY KEY,
    "nombre" VARCHAR(20) NOT NULL,
    "fecha_inicio" DATE NOT NULL, -- Define cuando inicia un nuevo periodo
    "fecha_fin" DATE NOT NULL,    -- Define cuando termina el periodo
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    UNIQUE (nombre),

    -- VALIDACIÓN 1: Asegura que el fin siempre sea posterior al inicio.
    CHECK (fecha_fin > fecha_inicio),

    -- VALIDACIÓN 2: Regla CRÍTICA de No Solapamiento (Exclusion Constraint).
    -- Utiliza el tipo DATERANGE para asegurar que el rango [inicio, fin] de un periodo
    -- no se cruce (&&) con el rango de ningún otro periodo ya existente.
    EXCLUDE USING gist (DATERANGE(fecha_inicio, fecha_fin, '[)') WITH &&) 
);



-- 3.4. GRUPO (Instancia de un curso)
CREATE TABLE grupo (
    "id_grupo" SERIAL PRIMARY KEY,
    "id_curso" INT REFERENCES curso(id_curso) NOT NULL,
    "id_periodo" INT REFERENCES periodo(id_periodo) NOT NULL,
    "id_modalidad" INT REFERENCES modalidad_clase(id_modalidad) NOT NULL,
    "id_docente" INT REFERENCES docente(id_docente) NOT NULL,
    "cupo_maximo" INT NOT NULL,
    "nombre" VARCHAR(50) NOT NULL,
    "costo_unitario_clase" NUMERIC(10, 2) NOT NULL, 
    "costo_inscripcion" NUMERIC(10, 2) NOT NULL,
	"id_estado" INT REFERENCES estado_grupo(id_estado_grupo) NOT NULL,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    
    UNIQUE (id_curso, id_periodo, nombre)
);




-- 3.7. inscripcion (Estudiante inscrito en un grupo)
CREATE TABLE inscripcion (
    "id_inscripcion" SERIAL PRIMARY KEY,
    "id_grupo" INT REFERENCES grupo(id_grupo) NOT NULL,
    "id_estudiante" INT REFERENCES estudiante(id_estudiante) NOT NULL,
	"id_estado" INT REFERENCES estado_inscripcion(id_estado_inscripcion) NOT NULL,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,

    UNIQUE (id_estudiante, id_grupo)
);



-- #######################################################
-- # 4. MÓDULO CONTABLE (PLAN DE CUENTAS)
-- #######################################################

-- 4.1. PLAN_CUENTA
CREATE TABLE plan_cuenta (
    "id_plan_cuenta" SERIAL PRIMARY KEY,
	"nombre" VARCHAR(100) NOT NULL,
    "codigo" VARCHAR(20) UNIQUE NOT NULL,
    "nivel" INT NOT NULL,
    "id_naturaleza" INT REFERENCES naturaleza(id_naturaleza) NOT NULL,
	"id_clasificacion" INT REFERENCES clasificacion(id_clasificacion) NOT NULL,
    "id_padre" INT REFERENCES plan_cuenta(id_plan_cuenta),
	"estado" BOOL DEFAULT TRUE,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL

);

-- 4.2. CUENTA_BANCARIA (Almacena el registro único y físico de la cuenta)
CREATE TABLE cuenta_bancaria (

    "id_cuenta_bancaria" SERIAL PRIMARY KEY,
    
    -- Datos de la cuenta
    "numero_cuenta" VARCHAR(20) NOT NULL, -- 20 dígitos estándar venezolano
    
    -- Tipo de cuenta (Ahorro/Corriente)
    "id_tipo_cuenta" INTEGER NOT NULL REFERENCES tipo_cuenta_bancaria(id_tipo_cuenta),
    
    -- Banco al que pertenece
    "id_banco" INTEGER NOT NULL REFERENCES banco(id_banco),
    
    -- PROPIETARIO/TITULAR DE LA CUENTA
    "id_entidad_titular" INTEGER NOT NULL REFERENCES entidad(id_entidad),
    
    -- ESTADO DE LA CUENTA
    "id_estado_cuenta" INTEGER NOT NULL REFERENCES estado_cuenta_bancaria(id_estado_cuenta),

    "createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
"approvedAt" TIMESTAMP WITHOUT TIME ZONE,
    

    -- Restricción: No puede haber dos cuentas con el mismo número y banco (solo el objeto físico es único)
    UNIQUE (numero_cuenta, id_banco)
);



-- 4.3. ENTIDAD_CUENTA_ASOCIACION (Tabla de enlace entre la entidad asociada y la cuenta)
CREATE TABLE entidad_cuenta_asociacion (

    "id_asociacion" SERIAL PRIMARY KEY,
    
    -- Referencia a la cuenta física única
    "id_cuenta_bancaria" INTEGER NOT NULL REFERENCES cuenta_bancaria(id_cuenta_bancaria),
    
    -- ENTIDAD ASOCIADA 
    "id_entidad_asociada" INTEGER NOT NULL REFERENCES entidad(id_entidad), 
    
    -- El clasificador que indica el CONTEXTO del rol asociado (para pagar por ser docente o proveedor o para recibir pagos por 
    --ser estudiante)
    id_tipo_rol INTEGER NOT NULL REFERENCES tipo_rol_asociado(id_tipo_rol), 
    
    -- VIGENCIA DE LA ASOCIACIÓN 
    es_vigente BOOLEAN NOT NULL DEFAULT TRUE,

    -- Una Entidad solo puede usar una Cuenta Maestra una vez para un Contexto de Rol (e.g., No puede tener la misma cuenta para dos roles de "docente").
    UNIQUE (id_entidad_asociada, id_tipo_rol, id_cuenta_bancaria)
);




-- 4.4. OBLIGACION_FINANCIERA (SUPER-TIPO: Centro de Unificación de Deudas - Instrumento Financiero)
-- Lo que hace es generar el id de cualquier obligación financiera (hacia la academia o de la academia) y de darle ese id 
--a las tablas "obligacion_inscripcion"
CREATE TABLE obligacion_financiera (
    id_obligacion SERIAL PRIMARY KEY, 
    id_entidad INT NOT NULL, 
    id_concepto INT NOT NULL, 
    id_tipo_comprobante INT NOT NULL, 
    id_estado INT NOT NULL, 

 
    numero_documento VARCHAR(30) UNIQUE, -- No es "NOT NULL" ya que, aunque muchos comprobantes financieros (Facturas, Recibos de Nómina) tienen un número único, hay tipos de obligaciones que nacen de eventos internos o proyecciones que quizás no tienen un número de documento físico o legal inmediato.
    fecha_emision DATE NOT NULL,
    fecha_vencimiento DATE,
    
    monto_original DECIMAL(10, 2) NOT NULL,
    id_divisa INT NOT NULL, 

    "createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    
    FOREIGN KEY (id_entidad) REFERENCES entidad(id_entidad),
    FOREIGN KEY (id_concepto) REFERENCES concepto_financiero(id_concepto),
    FOREIGN KEY (id_tipo_comprobante) REFERENCES tipo_comprobante(id_comprobante),
    FOREIGN KEY (id_divisa) REFERENCES divisa(id_divisa), 
    FOREIGN KEY (id_estado) REFERENCES estado_obligacion(id_estado_obligacion), 

    CHECK (monto_original > 0)
);

-- 4.5. OBLIGACION_INSCRIPCION (SUB-TIPO 1: Enlace simple 1:N)
-- Conecta a la tabla de obligacion_financiera con la de inscripcion, permitiendo mantener la integridad referencial y que si
--existe una inscripcion para las obligaciones que puedan surgir de un estudiante (de pagar la inscripcion o las clases)
CREATE TABLE obligacion_inscripcion (
    id_obligacion INT PRIMARY KEY,  
    id_inscripcion INT NOT NULL,    

    FOREIGN KEY (id_obligacion) REFERENCES obligacion_financiera(id_obligacion),
    FOREIGN KEY (id_inscripcion) REFERENCES inscripcion(id_inscripcion)
);


-- 4.6. REGISTRO_TRANSACCION (Tabla de Pagos/Cobros Centralizada - Sin detalles bancarios)
CREATE TABLE registro_transaccion (
    id_transaccion SERIAL PRIMARY KEY,
    id_obligacion INT NOT NULL, 
    id_entidad_realiza INT NOT NULL, 
    id_tipo_movimiento INT NOT NULL, 
    id_metodo_pago INT NOT NULL, 
	id_divisa INT NOT NULL, 
	
    monto_transaccion DECIMAL(10, 2) NOT NULL,
    referencia_transaccion VARCHAR(100), -- Permite NULL. La obligatoriedad depende del METODO_PAGO (transferencia, cheque, etc.)
    fecha_transaccion DATE NOT NULL,

    "createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,

    FOREIGN KEY (id_obligacion) REFERENCES obligacion_financiera(id_obligacion),
    FOREIGN KEY (id_entidad_realiza) REFERENCES entidad(id_entidad),
    FOREIGN KEY (id_divisa) REFERENCES divisa(id_divisa), 
    FOREIGN KEY (id_tipo_movimiento) REFERENCES tipo_movimiento(id_tipo_movimiento),
	FOREIGN KEY (id_metodo_pago) REFERENCES metodo_pago(id_metodo_pago),
    
    CHECK (monto_transaccion > 0)
);


-- 4.7. TRANSACCION_BANCARIA_DETALLE (Detalle Opcional para Transacciones Bancarias)
-- Esta tabla existe si el METODO_PAGO asociado a REGISTRO_TRANSACCION es 'TRANSFERENCIA' o 'PAGO MOVIL'
CREATE TABLE transaccion_bancaria_detalle (
    id_transaccion INT PRIMARY KEY, -- Clave Primaria y Foránea 1:1 con REGISTRO_TRANSACCION
    id_cuenta_origen INT NOT NULL, 
    id_cuenta_destino INT NOT NULL, 
    
    FOREIGN KEY (id_transaccion) REFERENCES registro_transaccion(id_transaccion),
    FOREIGN KEY (id_cuenta_origen) REFERENCES cuenta_bancaria(id_cuenta_bancaria),
    FOREIGN KEY (id_cuenta_destino) REFERENCES cuenta_bancaria(id_cuenta_bancaria)
);



-- 4.8. ASIENTO_ENCABEZADO (Cabecera del Asiento Contable)
CREATE TABLE asiento_encabezado (
    "id_asiento" SERIAL PRIMARY KEY,
    "id_tipo_comprobante" INT REFERENCES tipo_comprobante(id_comprobante) NOT NULL,

    -- Enlaces a la tabla Operacional que origina el asiento (la fuente de verdad del negocio)
    "id_obligacion_origen" INT REFERENCES obligacion_financiera(id_obligacion), 
    "id_transaccion_origen" INT REFERENCES registro_transaccion(id_transaccion),

    "numero_comprobante" VARCHAR(50) NOT NULL,
    "fecha_transaccion" DATE NOT NULL,
    "descripcion" VARCHAR(255) NOT NULL,
    "total_debito" NUMERIC(12, 2) NOT NULL,
    "total_credito" NUMERIC(12, 2) NOT NULL,
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    
    CHECK (total_debito = total_credito)
);



-- 4.9. ASIENTO_DETALLE (Detalle de las Cuentas Afectadas)
CREATE TABLE asiento_detalle (
    "id_detalle" SERIAL PRIMARY KEY,
    "id_asiento" INT REFERENCES asiento_encabezado(id_asiento) NOT NULL,
    "id_plan_cuenta" INT REFERENCES plan_cuenta(id_plan_cuenta) NOT NULL,
    "monto" DECIMAL(12, 2) NOT NULL,
    "naturaleza_movimiento" INT REFERENCES naturaleza(id_naturaleza) NOT NULL,
    "descripcion" VARCHAR(255),
	"createdAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL,
	"updatedAt" TIMESTAMP WITHOUT TIME ZONE NOT NULL
);






-- #######################################################
-- # 5. algunas tablas que se olvidó la ia
-- #######################################################

-- 5.1. TASA CAMBIO
CREATE TABLE tasa_cambio (
    "id_tasa_cambio" SERIAL PRIMARY KEY,
	"divisa_origen" INT REFERENCES divisa(id_divisa) NOT NULL,
	"divisa_destino" INT REFERENCES divisa(id_divisa) NOT NULL,
	"fecha_vigencia" DATE NOT NULL,
	"tasa_valor" NUMERIC(8, 2) NOT NULL,
    "fuente" VARCHAR(50) NOT NULL
);


-- 5.2. REGLA_PREFIJO_DOCUMENTO
CREATE TABLE regla_prefijo_documento(
    "id_regla" SERIAL PRIMARY KEY,
	"id_tipo_identificacion" INT REFERENCES tipo_identificacion(id_tipo_identificacion) NOT NULL,
	"id_prefijo" INT REFERENCES prefijo_identificacion(id_prefijo),
	"es_obligatorio" BOOL NOT NULL
);




-- #######################################################
-- # 6. MÓDULO FINANCIERO: INGRESOS
-- #######################################################





-- #######################################################
-- # 7. MÓDULO FINANCIERO: EGRESOS (NÓMINA)
-- #######################################################




-- #######################################################
-- # 8. MÓDULO FINANCIERO: EGRESOS (GASTOS OPERACIONALES)
-- #######################################################






-- ##############################################################################################################
-- INSERTAR DATOS
-- ##############################################################################################################


-- Primero hacemos que se borren los datos de todas las tablas (que igual no tienen datos pero hay que reiniciar la secuencia (la clave primaria)
--) para evitar problemas (ya que por ejemplo, si apenas estamos insertando datos puede salir que el id comience en "10", rompiendo cualquier lógica
-- si contamos con que inicien con el 1)
TRUNCATE TABLE naturaleza RESTART IDENTITY CASCADE;
TRUNCATE TABLE clasificacion RESTART IDENTITY CASCADE;
TRUNCATE TABLE plan_cuenta RESTART IDENTITY CASCADE;
TRUNCATE TABLE tipo_entidad RESTART IDENTITY CASCADE;
TRUNCATE TABLE prefijo_identificacion RESTART IDENTITY CASCADE;
TRUNCATE TABLE tipo_identificacion RESTART IDENTITY CASCADE;
TRUNCATE TABLE regla_prefijo_documento RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_academico RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_docente RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_cuenta_bancaria RESTART IDENTITY CASCADE;
TRUNCATE TABLE tipo_cuenta_bancaria RESTART IDENTITY CASCADE;
TRUNCATE TABLE banco RESTART IDENTITY CASCADE;
TRUNCATE TABLE cuenta_bancaria RESTART IDENTITY CASCADE;
TRUNCATE TABLE tipo_rol_asociado RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_proveedor RESTART IDENTITY CASCADE;
TRUNCATE TABLE tipo_proveedor RESTART IDENTITY CASCADE;
TRUNCATE TABLE categoria_curso RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_curso RESTART IDENTITY CASCADE;
TRUNCATE TABLE modalidad_clase RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_grupo RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_inscripcion RESTART IDENTITY CASCADE;
TRUNCATE TABLE estado_obligacion RESTART IDENTITY CASCADE;
TRUNCATE TABLE concepto_financiero RESTART IDENTITY CASCADE;
TRUNCATE TABLE tipo_comprobante RESTART IDENTITY CASCADE;



-- 1.1. NATURALEZA (Naturalezas de las cuentas)
INSERT INTO naturaleza ("nombre") VALUES ('Deudora'), ('Acreedora');


-- 1.2. CLASIFICACION (Naturalezas de las cuentas)
INSERT INTO clasificacion ("nombre") VALUES ('Real'), ('Nominal');



-- 1.3. PLAN_CUENTA (Algunas cuentas del plan)
INSERT INTO plan_cuenta ("nombre", "codigo", "nivel", "id_naturaleza", "id_clasificacion", "estado", "id_padre", "createdAt", "updatedAt") VALUES

    -- Cuentas de nivel 1

    ('activo', '1', 1, 1, 1, true, null, NOW(), NOW()),
    ('pasivo', '2', 1, 2, 1, true, null, NOW(), NOW()),
    ('patrimonio', '3', 1, 2, 1, true, null, NOW(), NOW()),
    ('ingreso', '4', 1, 2, 2, true, null, NOW(), NOW()),
    ('costo', '5', 1, 1, 2, true, null, NOW(), NOW()),
    ('gasto', '6', 1, 1, 2, true, null, NOW(), NOW()),

    -- Cuentas de nivel 2

        ('activo corriente', '11', 2, 1, 1, true, 1, NOW(), NOW()),
        ('activo no corriente', '12', 2, 1, 1, true, 1, NOW(), NOW()),

        ('pasivo corriente', '21', 2, 2, 1, true, 2, NOW(), NOW()),
        ('pasivo no corriente', '22', 2, 2, 1, true, 2, NOW(), NOW()),

        ('capital', '31', 2, 2, 1, true, 3, NOW(), NOW()),
        ('resultados', '32', 2, 2, 1, true, 3, NOW(), NOW()),

        ('ingresos operacionales', '41', 2, 2, 2, true, 4, NOW(), NOW()),
        ('ingreso no operacionales', '42', 2, 2, 2, true, 4, NOW(), NOW()),

        ('costo de producción', '51', 2, 1, 2, true, 5, NOW(), NOW()),
        ('costo de venta', '52', 2, 1, 2, true, 5, NOW(), NOW()),
        ('costo de servicios', '53', 2, 1, 2, true, 5, NOW(), NOW()),
        ('costo contrato de construcción', '54', 2, 1, 2, true, 5, NOW(), NOW()),

        ('gastos operacionales', '61', 2, 1, 2, true, 6, NOW(), NOW()),
        ('gastos no operacionales', '62', 2, 1, 2, true, 6, NOW(), NOW());



-- 1.4. TIPO_ENTIDAD (Tipos de entidades del sistema)
INSERT INTO tipo_entidad ("nombre", "descripcion") VALUES
('Persona Natural', 'Individuo con identidad propia'),
('Persona Jurídica', 'Empresa, institución o sociedad'),
('Entidad Interna', 'La propia academia como sujeto contable'); -- Para registrar sus cuentas bancarias, movimientos internos, etc. Por ejemplo, si la academia transfiere dinero entre sus propias cuentas (como de una cuenta de ahorro a una cuenta corriente), necesita aparecer como el remitente y el receptor en esa transacción)


-- 1.5. PREFIJO_IDENTIFICACION (Para saber que se coloca antes del número de identificación)
INSERT INTO prefijo_identificacion ("letra_prefijo", "descripcion") VALUES
('V', 'Venezolano'),
('E', 'Extranjero (Residente)'),
('P', 'Pasaporte (Uso Temporal)'),
('J', 'Persona Jurídica (Empresa)'),
('G', 'Gubernamental (Estado)');


-- 1.6. TIPO_IDENTIFICACION (Documentos de Identidad)
INSERT INTO tipo_identificacion ("id_tipo_identificacion", "nombre", "abreviatura") VALUES
(1, 'Cédula de Identidad Venezolana', 'C.I.'),
(2, 'Pasaporte', 'PAS'),
(3, 'Registro de Información Fiscal', 'R.I.F.'),
(4, 'Partida de Nacimiento', 'P.N.'); -- Para menores de edad
-- (5, 'Otro Documento', 'OTRO'); Para casos especiales. Omitido de este sistema


-- 1.7. regla_prefijo_documento (Las identificaciones con sus prefijos)
INSERT INTO regla_prefijo_documento ("id_tipo_identificacion", "id_prefijo", "es_obligatorio") VALUES
(1, 1, TRUE), -- Cédula -> Venezolano (Obligatorio el prefijo)
(1, 2, TRUE), -- Cédula -> Extranjero (Obligatorio el prefijo)
(2, 3, TRUE), -- Pasaporte (Obligatorio el prefijo)
(3, 4, TRUE), -- RIF -> Persona Jurídica (Obligatorio el prefijo)
(3, 5, TRUE), -- RIF -> Gubernamental (Obligatorio el prefijo)
(3, 1, false), -- RIF -> Venezolano (Personas naturales venezolanas que solo usan RIF) (No obligatorio el prefijo)
(3, 2, false), -- RIF -> Extranjero (Personas naturales extranjeras que solo usan RIF) (No obligatorio el prefijo)
(4, 1, TRUE); -- Partida de Nacimiento -> Venezolano (Obligatorio el prefijo)
-- (5, null, null); Otro Documento -> Ninguno (Actualmente, no tiene reglas de prefijo asignadas)



-- 1.8. ENTIDAD
INSERT INTO entidad (
    "id_tipo_entidad", 
    "id_tipo_identificacion", 
    "id_prefijo", 
    "numero_identificacion", 
    "nombre", 
    "apellido",
    "email",
    "telefono",
    "direccion",
    "estado",
    "createdAt",
    "updatedAt"
) VALUES
(3, 3, 4, '20015849', 'academia', null, 'academia@gmail.com', '04268675867', 'barquisimeto', true, NOW(), NOW()),
(2, 3, 5, '20010014-1', 'corpoelec', null, 'corpoelec@gmail.com', '04127564982', 'barquisimeto', true, NOW(), NOW()),
(2, 3, 5, '20009014-6', 'hidrolara', null, 'hidrolara@gmail.com', '04269857619', 'barquisimeto', true, NOW(), NOW()),
(1, 1, 1, '147567458', 'maria', 'lopez', 'ml57@gmail.com', '04145636985', 'el manzano', true, NOW(), NOW()),
(1, 1, 1, '156987458', 'carlos', 'gomez', 'carlitos54@gmail.com', '02124569878', 'trinitarias', true, NOW(), NOW()),
(1, 1, 2, '327465458', 'enrique', 'peña', 'enrique46@gmail.com', '04124569874', 'el manzano', true, NOW(), NOW()),
(1, 2, 3, '145647849', 'vladimir', 'putin', 'vladimir66@hotmail.com', '04245847968', 'rusia', true, NOW(), NOW()),
(1, 1, 1, '145647849', 'petra', 'ribas', 'petra77@gmail.com', '04165897458', 'cabudare', true, NOW(), NOW()),


(1, 1, 1, '132684578', 'ana', 'lopez', 'anita57@gmail.com', '04124587989', 'trujillo', true, '2024-05-15 09:30:00', '2024-05-15 09:30:00'),
(1, 1, 1, '121254678', 'alberto', 'alvarado', 'albertito46@gmail.com', '02124467878', 'valencia', true, '2025-06-15 09:38:00', '2025-08-18 10:30:00'),
(1, 1, 2, '327446788', 'john', 'correa', 'jonh333@gmail.com', '041241302074', 'altamira', true, '2025-07-11 09:30:00', '2024-08-26 11:50:00'),
(1, 2, 3, '149188849', 'nicolas', 'rodriguez', 'nico4366@hotmail.com', '04265877968', 'colombia', true, '2025-07-19 09:30:00', '2025-07-22 09:30:00'),
(1, 1, 1, '197685449', 'ricardo', 'fernandez', 'fernan89@gmail.com', '04141243458', 'tucupita', true, '2024-10-20 09:30:00', '2024-11-18 09:30:00');



-- 1.9. estado_academico
INSERT INTO estado_academico ("nombre", "descripcion", "permite_inscripcion") VALUES 
('Activo', 'El estudiante está cursando actualmente, o se encuentra en una pausa autorizada', true),
('Egresado', 'Ha completado satisfactoriamente todos los cursos en los que se ha inscrito', true),
('Retirado', 'El estudiante abandonó formalmente todos los cursos antes de finalizarlos', true),
('Suspendido', 'El estudiante no puede inscribirse en nuevos cursos por motivos disciplinarios o incumplimiento de normas', false),
('Moroso', 'El estudiante tiene cuotas pendientes de pago y no puede inscribirse en nuevos cursos', false);



-- 1.10. ESTADO_DOCENTE (Estado del Docente)
INSERT INTO estado_docente ("nombre", "descripcion", "permite_asignacion", "aplica_pago") VALUES
('Activo', 'Docente disponible para recibir asignaciones de cursos y liquidación por horas.', TRUE, TRUE),
('Inactivo', 'Docente que no está asignado a cursos y no debe recibir pagos por hora.', FALSE, FALSE),
('Ausencia Autorizada', 'Docente con permiso temporal autorizado, que no puede ser asignado ni se le paga por hora.', FALSE, FALSE),
('Suspendido', 'Docente que no puede ser asignado por motivos disciplinarios o legales, y no aplica pago.', FALSE, FALSE);


-- 1.11. ESTADO_CUENTA_BANCARIA (Estado Operativo de la Cuenta)
INSERT INTO estado_cuenta_bancaria ("nombre", "descripcion", "permite_operacion") VALUES
('Activa', 'La cuenta está verificada y lista para recibir pagos.', TRUE),
('Inactiva', 'Cuenta desactivada temporalmente por administración o porque ya no es necesaria.', FALSE),
('Bloqueada', 'La cuenta ha sido reportada como suspendida por el banco.', FALSE),
('Cerrada', 'El titular canceló la cuenta en el banco.', FALSE),
('Pendiente de Validación', 'Cuenta recién ingresada y pendiente de verificación interna.', FALSE); 


-- 1.12. TIPO_CUENTA_BANCARIA (Ahorro, Corriente)
-- Nota: Para simplificar por factor tiempo se descarta el tipo de cuenta de moneda extranjera
--ya que habria que verificar la divisa, codigos adicionales, que la transferencia sea
--del mismo tipo de moneda, etc
INSERT INTO tipo_cuenta_bancaria ("nombre", "descripcion") VALUES
('Corriente', 'Cuenta bancaria que permite el uso de cheques y transferencias frecuentes.'),
('Ahorro', 'Cuenta bancaria destinada a la custodia de fondos con menos transacciones.');


-- 1.13. BANCO (Instituciones Financieras Venezolanas)
INSERT INTO banco ("nombre", "codigo_nacional", "codigo_swift") VALUES
('Banco de Venezuela', '0102', 'BVSA VE CC'),
('Banesco', '0134', 'BFNC VE CM'),
('Banco Mercantil', '0105', 'BVEN VE CC'),
('BBVA Provincial', '0108', 'BPVA VE CP'),
('BOD (Bco. Occidental de Descuento)', '0116', 'BODV VE CA'),
('Banco Activo', '0138', 'BACP VE CA'),
('Bancaribe', '0114', 'CARV VE CM'),
('Banco del Tesoro', '0163', 'BTVO VE CA'),
('Bancrecer', '0168', 'BLCF VE CA');



-- 1.14. CUENTA BANCARIA
INSERT INTO cuenta_bancaria (
    "numero_cuenta", 
    "id_banco", 
    "id_tipo_cuenta",    
    "id_entidad_titular", 
    "id_estado_cuenta", 
    "createdAt",
    "updatedAt",
    "approvedAt"   
    ) VALUES

    -- Cuentas aprobadas
('01026574386954345607', 1, 2, 1, 1, '2025-03-12 14:30:00', '2025-05-14 14:30:00', '2025-04-10 14:30:00'),
('01346574373737375607', 2, 1, 2, 2, '2025-09-09 14:30:00', '2025-09-09 14:30:00', '2025-10-02 14:30:00'),
('01026574847346345607', 1, 2, 3, 3, '2025-08-07 14:30:00', '2025-08-07 14:30:00', '2025-08-15 14:30:00'),
('01086574968703345607', 4, 1, 4, 4, '2025-10-06 14:30:00', '2025-11-06 14:30:00', '2025-10-13 14:30:00'),
('01021728446954345607', 1, 1, 5, 2, '2025-05-04 14:30:00', '2025-05-09 14:30:00', '2025-05-06 14:30:00'),
('01386424375485545607', 6, 1, 6, 1, NOW(), NOW(), NOW()),
('01054800203954345607', 3, 2, 7, 3, '2025-09-09 14:30:00', '2025-09-09 14:30:00', NOW()),
('01026574535454345607', 1, 2, 8, 2, '2024-08-02 14:30:00', '2025-09-09 14:30:00', '2025-03-02 14:30:00'),
('01026388244954345607', 1, 1, 1, 3, NOW(), NOW(), NOW()),

    -- Cuentas por aprobar
('01686572423454345607', 9, 1, 2, 5, '2025-05-10 14:30:00', '2025-05-10 14:30:00', null),
('01146574600864345607', 7, 1, 3, 5, '2025-06-15 14:30:00', '2025-06-15 14:30:00', null),
('01026564564444345607', 1, 2, 4, 5, '2025-04-12 14:30:00', '2025-04-12 14:30:00', null),
('01686573819954345607', 9, 1, 5, 5, NOW(), NOW(), null),
('01026559490000445607', 1, 2, 6, 5, '2025-05-15 14:30:00', '2025-05-15 14:30:00', null),
('01026574654334345607', 1, 1, 7, 5, '2025-03-14 14:30:00', '2025-03-14 14:30:00', null),
('01026564644332345607', 1, 2, 8, 5, NOW(), NOW(), null),
('01686578678678645607', 9, 1, 1, 5, '2025-02-20 14:30:00', '2025-02-20 14:30:00', null),
('01026559490353534607', 1, 2, 2, 5, '2025-01-02 14:30:00', '2025-01-02 14:30:00', null),
('01026573456667345607', 1, 1, 3, 5, '2024-07-28 14:30:00', '2024-07-28 14:30:00', null),
('01636574300043045607', 8, 1, 4, 5, NOW(), NOW(), null);



-- 1.14. TIPO_ROL_ASOCIADO (Roles que pueden tener cuentas bancarias asociadas para PAGAR o RECIBIR pagos.)
INSERT INTO tipo_rol_asociado ("nombre", "descripcion") VALUES
('docente', 'Contexto para pagos de nómina o viáticos dirigidos al Docente.'),
('proveedor', 'Contexto para pagos de facturas dirigidos al Proveedor.'),
('estudiante', 'Contexto para cuentas de donde el Estudiante realiza los pagos (Matrículas/Aranceles).'),
('institución propia', 'Contexto para cuentas de la Academia usadas para emitir o recibir pagos.'); -- SI la cuenta bancaria a asociar es para la cuenta de la propia academia, se necesita un cuarto rol



-- 1.15. ESTADO_PROVEEDOR 
INSERT INTO estado_proveedor (nombre, descripcion, permite_pago) VALUES
('Activo', 'Proveedor con contrato vigente y autorizado para recibir pagos.', TRUE),
('Inactivo', 'Proveedor marcado como inactivo por: falta de uso prolongado, no renovación de documentos menores, o solicitud de pausa.', FALSE),
--('En Evaluación', 'Proveedor recién registrado, pendiente de aprobación contractual o documental.', FALSE),
--('Pre-Registro', 'Proveedor que ha iniciado el registro pero no ha completado los requisitos iniciales.', FALSE),
('Contrato Vencido', 'Relación vigente, pero el contrato requiere renovación.', FALSE),
('Bloqueado', 'Proveedor vetado por incumplimiento o motivos legales.', FALSE);


-- 1.16. TIPO_PROVEEDOR
INSERT INTO tipo_proveedor (nombre, descripcion) VALUES
('Servicios de TI/Software', 'Proveedores de sistemas, licencias, mantenimiento y desarrollo de software.'),
('Suministros de Oficina', 'Proveedores de papelería, cartuchos, insumos de impresión y material de escritorio.'),
('Mantenimiento de Infraestructura', 'Proveedores de servicios de plomería, electricidad, A/C, limpieza y reparaciones del edificio.'),
('Consultoría/Legal/Auditoría', 'Servicios profesionales no recurrentes (asesoría legal, auditorías externas, finanzas).'),
('Marketing y Publicidad', 'Proveedores para campañas, diseño gráfico, gestión de redes sociales y medios.'),
('Bancos e Instituciones Financieras', 'Proveedores de servicios de pago, pasarelas de cobro o servicios bancarios específicos.'),
('Servicios de Transporte y Logística', 'Proveedores de mensajería, paquetería y transporte para eventos o personal.'),
('Alimentos y Bebidas (Catering)', 'Proveedores para el cafetín, eventos, reuniones o servicios de comida para personal/alumnos.'),
('Material Didáctico y Bibliografía', 'Proveedores de libros, e-books, licencias de bibliotecas digitales y material específico de enseñanza.'),
('Servicios de Seguridad y Vigilancia', 'Empresas de seguridad física, alarmas y monitoreo.');


-- 1.17. ESTADO_CURSO
INSERT INTO estado_curso (nombre, descripcion, permite_nuevos_grupos) VALUES
('Activo', 'El curso está disponible y se pueden crear nuevos grupos.', TRUE),
('En Revisión', 'El contenido está siendo actualizado; no se permiten nuevos grupos.', FALSE),
('Decontinuado', 'El curso ya no se ofrece, no se permiten nuevos grupos.', FALSE);


-- 1.18. CATEGORIA_CURSO
INSERT INTO categoria_curso (nombre, descripcion, id_categoria_padre) VALUES

    -- =========================================================================================
    -- CATEGORÍAS PADRE (NIVEL 1) - Estos IDs serán 1, 2, 3, 4, 5, 6
    -- =========================================================================================
    ('Tecnología y Programación', 'Cursos fundamentales de desarrollo de software y sistemas.', NULL),          
    ('Diseño y Arte Digital', 'Cursos de creatividad, branding y producción multimedia.', NULL),               
    ('Negocios y Gestión', 'Cursos sobre emprendimiento, finanzas y administración de proyectos.', NULL),      
    ('Idiomas y Comunicación', 'Cursos de lenguas extranjeras y mejora de habilidades blandas.', NULL),        
    ('Ciencia de Datos y Analítica', 'Cursos de estadística, bases de datos y machine learning.', NULL),       
    ('Habilidades Profesionales', 'Cursos transversales para mejorar el rendimiento laboral.', NULL);
    -- =========================================================================================


INSERT INTO categoria_curso (nombre, descripcion, id_categoria_padre) VALUES

    -- =========================================================================================
    -- SUBCATEGORÍAS (NIVEL 2) - Referencias a los IDs 1-6
    -- Se usan los IDs que se espera que se asignen secuencialmente (1, 2, 3, 4, 5, 6)
    -- Se insertan aparte porque sino todas estarán en "null" para el padre
    -- =========================================================================================

    -- Subcategorías de TECNOLOGÍA Y PROGRAMACIÓN (Padre ID: 1)
    ('Desarrollo Web Front-End', 'HTML, CSS, JavaScript y frameworks modernos.', 1),                         
    ('Desarrollo Web Back-End', 'Python, Node.js, PHP y API REST.', 1),                                     
    ('Desarrollo Mobile Nativo', 'Swift, Kotlin, Java para iOS y Android.', 1),                                 
    ('DevOps e Infraestructura', 'Docker, Kubernetes, AWS/Azure/GCP e Infraestructura como Código.', 1), 
    ('Ciberseguridad y Redes', 'Defensa de sistemas, hacking ético y gestión de redes.', 1),

    -- Subcategorías de DISEÑO Y ARTE DIGITAL (Padre ID: 2)
    ('Diseño Gráfico y Branding', 'Illustrator, Photoshop, identidad visual y teoría del color.', 2),          
    ('Diseño UX/UI Avanzado', 'Investigación de usuarios, prototipado y diseño de interacción.', 2),                    
    ('Modelado 3D', 'Blender, Maya y texturizado.', 2),                                                  
    ('Animación y Motion Graphics', 'After Effects, principios de animación y producción de gráficos en movimiento.', 2),            
    ('Fotografía y Retoque', 'Composición, iluminación y postproducción fotográfica.', 2),

    -- Subcategorías de NEGOCIOS Y GESTIÓN (Padre ID: 3)
    ('Gestión de Proyectos (Agile)', 'Scrum, Kanban y herramientas de gestión de equipos.', 3),                
    ('Finanzas Corporativas', 'Análisis financiero, valoración de empresas y capital de trabajo.', 3),                
    ('Contabilidad y Auditoría', 'Normas internacionales, contabilidad básica y auditoría interna.', 3),       
    ('Marketing Digital Estratégico', 'Estrategia de contenidos, SEO/SEM avanzado y análisis de ROI.', 3),                         
    ('Emprendimiento y Startups', 'Modelo Canvas, validación de ideas y captación de fondos.', 3),

    -- Subcategorías de IDIOMAS Y COMUNICACIÓN (Padre ID: 4)
    ('Inglés', 'Todos los niveles y especializaciones (General, Negocios, Técnico).', 4), 
    ('Francés', 'Todos los niveles y especializaciones (General, Negocios, Técnico).', 4), 
    ('Alemán', 'Todos los niveles y especializaciones (General, Negocios, Técnico).', 4),
    ('Ruso', 'Todos los niveles y especializaciones (General, Negocios, Técnico).', 4), 
    ('Portugués', 'Todos los niveles y especializaciones (General, Negocios, Técnico).', 4), 
    ('Italiano', 'Todos los niveles y especializaciones (General, Negocios, Técnico).', 4),                             
    ('Español', 'Gramática, inmersión y cultura (Incluye español para extranjeros).', 4),
    ('Preparación de Certificaciones', 'Cursos enfocados en TOEFL, IELTS, Cambridge.', 4),
    ('Lenguas Orientales', 'Mandarín y Japonés para negocios y viajes.', 4),

    -- Subcategorías de CIENCIA DE DATOS Y ANALÍTICA (Padre ID: 5)
    ('Data Science', 'Herramientas, algoritmos, estadística y machine learning.', 5),
    ('Business Intelligence', 'Power BI, Tableau y creación de dashboards.', 5),                 
    ('Machine Learning e IA', 'Modelos predictivos, redes neuronales y Deep Learning.', 5),                      
    ('Bases de Datos', 'Modelado de datos, optimización de consultas SQL y NoSQL.', 5),

    -- Subcategorías de HABILIDADES PROFESIONALES (Padre ID: 6)
    ('Liderazgo y Gestión de Equipos', 'Coaching, mentoring y delegación efectiva.', 6),
    ('Productividad y Herramientas', 'Automatización, Excel avanzado y gestión del tiempo.', 6),
    ('Negociación y Resolución de Conflictos', 'Técnicas de negociación y manejo de objeciones.', 6)
;



-- 1.19. ESTADO_GRUPO
INSERT INTO estado_grupo (nombre, descripcion, permite_inscripcion) VALUES
('Planificado', 'El grupo ha sido creado y está listo para la oferta. Esperando inicio de clases. Acepta inscripciones.', TRUE),
('En curso', 'Las clases han comenzado. No se permiten nuevas inscripciones.', FALSE),
('Finalizado', 'El grupo terminó oficialmente todas sus sesiones de clase.', FALSE),
('Cancelado', 'El grupo fue cancelado antes o durante su ejecución (ej. por baja demanda o fuerza mayor).', FALSE);


-- 1.20. MODALIDAD_CLASE
INSERT INTO modalidad_clase (nombre, descripcion) VALUES
('Presencial', 'Clases impartidas físicamente en un aula o centro académico.'),
('Online', 'Clases impartidas de forma remota a través de plataformas de videoconferencia.'),
('Híbrida', 'Combinación de sesiones presenciales y remotas.');


-- 1.21. ESTADO_INSCRIPCION
INSERT INTO estado_inscripcion (nombre, descripcion, puede_ver_clase, ciclo_cerrado) VALUES
--('Solicitada', 'La solicitud de inscripción ha sido registrada, pero aún no ha sido revisada o aprobada.'),
('Pendiente de Pago', 'La inscripción está aprobada por la administración y pendiente de la recepción del pago inicial para confirmarse.', false, false),
('Activa', 'La inscripción está confirmada. El estudiante tiene un cupo activo y está participando en el grupo.', true, false),
('Retirada', 'El estudiante ha solicitado formalmente el retiro del curso o grupo antes de su finalización.', false, true),
('Anulada', 'Inscripción cancelada por la administración (e.g., por incumplimiento de pagos, cupo excedido o error administrativo).', false, true),
('Completada', 'El estudiante ha finalizado satisfactoriamente todas las clases y requisitos del curso.', false, true),
--('EN ESPERA', 'El estudiante está temporalmente pausado en el curso y planea retomar en un periodo futuro.'),
('Desertada', 'El estudiante dejó de asistir a clases sin notificar formalmente el retiro. (Estado final negativo).', false, true);


-- 1.22. ESTADO_OBLIGACION
INSERT INTO estado_obligacion (nombre, descripcion, es_finalizado) VALUES
('Emitida', 'La obligación ha sido creada y está pendiente de pago o ejecución.', FALSE),
('Pagada', 'La obligación ha sido saldada en su totalidad.', TRUE),
('Vencida', 'La fecha de vencimiento de la obligación ha pasado y sigue pendiente.', FALSE),
('Anulada', 'La obligación ha sido cancelada por motivos administrativos o retiro.', TRUE),
('Cobranza', 'La obligación se encuentra en proceso de cobro legal o externo.', FALSE); --Implica que la deuda es antigua, y el equipo de administración ha escalado la gestión. Puede involucrar: Agencias de cobro externas o Acciones legales.



-- 1.23. CONCEPTO_FINANCIERO
INSERT INTO concepto_financiero (nombre, descripcion, id_concepto_padre, es_por_cobrar, es_obligacion_negativa) VALUES

    -- =========================================================================================
    -- Nodos Raíz (Categorías Principales)
    -- =========================================================================================
    
    ('Ingresos Académicos', 'Agrupa todos los ingresos relacionados con la matrícula y el servicio educativo.', NULL, NULL, FALSE),
    ('Ajustes Académicos', 'Agrupa los conceptos que reducen el ingreso (reembolsos, descuentos).', NULL, NULL, FALSE),
    ('Costos de Nómina', 'Agrupa las obligaciones de pago al personal docente y administrativo.', NULL, NULL, FALSE),
    ('Gastos Operativos', 'Agrupa los gastos necesarios para el funcionamiento de la academia (proveedores).', NULL, NULL, FALSE);



INSERT INTO concepto_financiero (nombre, descripcion, id_concepto_padre, es_por_cobrar, es_obligacion_negativa) VALUES

    -- =========================================================================================
    -- Conceptos Transaccionales (Hijos directos de 1 - Cuentas por Cobrar)
    -- =========================================================================================

    ('Inscripción', 'Costo inicial por matricularse en un grupo.', 1, TRUE, FALSE),
    ('Cuota de Clase', 'Costo recurrente por el servicio educativo (clases).', 1, TRUE, FALSE),
    ('Cuota de Material', 'Cargo por material didáctico, libros o licencias de software educativo.', 1, TRUE, FALSE),
    ('Cuota de Certificación', 'Cargo por la emisión de diplomas o certificados de finalización.', 1, TRUE, FALSE),
    ('Multa por Retraso', 'Penalidad aplicada por pagos realizados después de la fecha de vencimiento.', 1, TRUE, FALSE),


    -- =========================================================================================
    -- Conceptos Transaccionales (Hijos directos de 2 - Ajustes Cuentas por Cobrar)
    -- =========================================================================================

    ('Reembolso', 'Monto devuelto a un estudiante por retiro o anulación. (Deuda de la academia al estudiante).', 2, TRUE, TRUE), 
    ('Descuento Promocional', 'Reducción en el monto de la obligación por la aplicación de una promoción.', 2, TRUE, TRUE),


    -- =========================================================================================
    -- Conceptos Transaccionales (Hijos directos de 3 - Cuentas por Pagar: Nómina)
    -- =========================================================================================

    ('Remuneración Docente', 'Pago por las clases impartidas (Docente).', 3, FALSE, FALSE),
    ('Bono Productividad', 'Pago adicional por cumplimiento de objetivos o mérito.', 3, FALSE, FALSE),
    ('Salario Administrativo', 'Sueldo mensual fijo para personal de oficina o administración.', 3, FALSE, FALSE),
    --('Aporte de Seguro Personal', 'Aportación de la academia a planes de seguro o beneficios.', 300, FALSE, FALSE),


    -- =========================================================================================
    -- Conceptos Transaccionales (Hijos directos de 400 - Cuentas por Pagar: Operativos)
    -- =========================================================================================

    ('Gasto de Alquiler', 'Pago mensual por arrendamiento de las instalaciones físicas.', 4, FALSE, FALSE),
    ('Gasto por Mantenimiento de la Sede', 'Reparaciones y mejoras a la infraestructura (limpieza, mantenimiento).', 4, FALSE, FALSE),
    ('Gasto de Servicios Básicos', 'Obligación por el consumo de luz, agua, gas e internet.', 4, FALSE, FALSE),
    ('Gastos por Publicidad/Marketing', 'Obligación generada por campañas de marketing y promoción.', 4, FALSE, FALSE),
    ('Gasto de Softwares/Licencias', 'Costo de licencias de software administrativo o educativo.', 4, FALSE, FALSE),
    ('Compra de Equipo', 'Compra de computadoras, proyectores, mobiliario, etc.', 4, FALSE, FALSE);




-- 1.24. TIPO_COMPROBANTE (se refiere al documento que crea la deuda o el crédito, no al medio por el cual se paga o se cobra)
INSERT INTO tipo_comprobante (nombre, descripcion, es_legal) VALUES

-- Propósito: Es el comprobante legal que formaliza una venta de bienes o servicios.
--Uso: Se utiliza para dar soporte a las obligaciones de Cuentas por Cobrar a los estudiantes (Inscripción, Cuota Clase, Materiales). Es el documento que genera un ingreso para la academia.
('Factura de Venta', 'Comprobante legal emitido al estudiante/cliente.', TRUE),


--Propósito: Es el comprobante legal que la academia recibe de un proveedor al adquirir bienes o servicios.
--Uso: Se utiliza para dar soporte a las obligaciones de Cuentas por Pagar por gastos operativos (Alquiler, Servicios, Equipos). Es el documento que genera un gasto o costo para la academia.
('Factura de Compra', 'Comprobante legal recibido del proveedor.', TRUE),


--Propósito: Es un documento fiscal que se emite para anular, disminuir o corregir una Factura de Venta previamente emitida.
--Uso: Es clave para dar soporte a los AJUSTES ACADÉMICOS, específicamente cuando registras un REEMBOLSO o un DESCUENTO_PROMOCIONAL que afecta el saldo de un cliente. Invierte el efecto de la factura original.
('Nota de Crédito', 'Documento que anula o disminuye una obligación (ej. para reembolsos o descuentos).', TRUE),


--Propósito: Documento de carácter legal (no fiscal) que establece un acuerdo de pago periódico o la obligación de un servicio continuo.
--Uso: Ideal para obligaciones que no tienen una factura por cada evento, sino por un acuerdo general, como la NÓMINA (el contrato docente establece la remuneración por clase) o el GASTO_ALQUILER (el contrato de arrendamiento genera la obligación mensual).
('Contrato', 'Documento que genera la obligación (ej. pago de nómina o alquiler).', FALSE),


--Propósito: Un documento interno de control que registra la recepción de un pago o la emisión de una obligación simple. Es provisional porque no sustituye una factura fiscal.
--Uso: Se puede usar internamente para registrar la obligación de una CUOTA_CLASE antes de que se emita la FACTURA_VENTA formal, o simplemente para llevar un control interno de cobros menores.
('Recibo Provisional', 'Documento interno o provisional de cobro de una cuota.', FALSE);



-- 1.25. DIVISA
INSERT INTO divisa (id_divisa, nombre, codigo, simbolo) VALUES
(1, 'Bolívar Venezolano', 'VES', 'Bs.'), 
(2, 'Dólar Estadounidense', 'USD', '$'), 
(3, 'Euro', 'EUR', '€'),
(4, 'Peso Colombiano', 'COP', 'COL\$'),
(5, 'Peso Mexicano', 'MXN', 'MXN\$'),
(6, 'Libra Esterlina', 'GBP', '£');